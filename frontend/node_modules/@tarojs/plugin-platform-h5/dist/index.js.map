{"version":3,"file":"index.js","sources":["../src/program.ts","../src/index.ts"],"sourcesContent":["import path from 'node:path'\n\nimport { transformAsync } from '@babel/core'\nimport { defaultMainFields, SCRIPT_EXT } from '@tarojs/helper'\nimport { TaroPlatformWeb } from '@tarojs/service'\n\nimport { resolveSync } from './utils'\n\nimport type { IPluginContext, TConfig } from '@tarojs/service'\n\nconst compLibraryAlias = {\n  vue3: 'vue3',\n  solid: 'solid',\n}\n\nconst PACKAGE_NAME = '@tarojs/plugin-platform-h5'\nexport default class H5 extends TaroPlatformWeb {\n  platform = 'h5'\n  runtimePath: string[] | string = `${PACKAGE_NAME}/dist/runtime`\n\n  constructor(ctx: IPluginContext, config: TConfig) {\n    super(ctx, config)\n    this.setupTransaction.addWrapper({\n      close() {\n        this.compiler === 'webpack5' ? this.modifyWebpackConfig() : this.modifyViteConfig()\n      },\n    })\n  }\n\n  get framework() {\n    return this.ctx.initialConfig.framework || 'react'\n  }\n\n  get useHtmlComponents() {\n    return !!this.ctx.initialConfig.h5?.useHtmlComponents\n  }\n\n  get useDeprecatedAdapterComponent() {\n    return !!this.ctx.initialConfig.h5?.useDeprecatedAdapterComponent\n  }\n\n  get apiLibrary() {\n    return require.resolve('./runtime/apis')\n  }\n\n  get aliasFramework(): string {\n    return compLibraryAlias[this.framework] || 'react'\n  }\n\n  protected mainFields = [...defaultMainFields]\n\n  get componentLibrary() {\n    if (this.useHtmlComponents && this.aliasFramework === 'react') {\n      if (this.framework === 'solid') {\n        return require.resolve('@tarojs/components-react/dist/solid')\n      }\n      return require.resolve('./runtime/components')\n    } else if (this.useDeprecatedAdapterComponent) {\n      return require.resolve(`@tarojs/components/lib/${this.aliasFramework}/component-lib`)\n    } else {\n      return require.resolve(`@tarojs/components/lib/${this.aliasFramework}`)\n    }\n  }\n\n  get componentAdapter() {\n    return path.join(path.dirname(require.resolve('@tarojs/components')), '..', 'lib')\n  }\n\n  get routerLibrary() {\n    const name = '@tarojs/router'\n    return (\n      resolveSync(name, {\n        // basedir: this.ctx.paths.appPath,\n        mainFields: this.mainFields,\n      }) || name\n    )\n  }\n\n  get libraryDefinition() {\n    return resolveSync('./definition.json', {\n      basedir: __dirname,\n    })!\n  }\n\n  /**\n   * ä¿®æ”¹ Webpack é…ç½®\n   */\n  modifyWebpackConfig() {\n    this.ctx.modifyWebpackChain?.(({ chain }) => {\n      // Note: æ›´æ–° mainFields é…ç½®ï¼Œç¡®ä¿ resolveSync èƒ½æ­£ç¡®è¯»å–åˆ°ç›¸å…³ä¾èµ–å…¥å£æ–‡ä»¶\n      const mainFields = chain.resolve.mainFields.values() || [...defaultMainFields]\n      if (mainFields.length > 0) {\n        this.mainFields = mainFields\n      }\n\n      const rules = chain.module.rules\n      const script = rules.get('script')\n      const babelLoader = script.uses.get('babelLoader')\n      const options = babelLoader.get('options')\n      babelLoader.set('options', {\n        ...options,\n        plugins: [\n          ...(options.plugins || []),\n          [\n            require('babel-plugin-transform-taroapi'),\n            {\n              packageName: '@tarojs/taro',\n              definition: require(this.libraryDefinition),\n            },\n          ],\n        ],\n      })\n\n      const alias = chain.resolve.alias\n      // TODO è€ƒè™‘é›†æˆåˆ° taroComponentsPath ä¸­ï¼Œä¸Žå°ç¨‹åºç«¯å¯¹é½\n      alias.set('@tarojs/components$', this.componentLibrary)\n      alias.set('@tarojs/components/lib', this.componentAdapter)\n      alias.set('@tarojs/router$', this.routerLibrary)\n      alias.set('@tarojs/taro', this.apiLibrary)\n      chain.plugin('mainPlugin').tap((args) => {\n        args[0].loaderMeta ||= {\n          extraImportForWeb: '',\n          execBeforeCreateWebApp: '',\n        }\n\n        // Note: æ—§ç‰ˆæœ¬é€‚é…å™¨ä¸ä¼šè‡ªåŠ¨æ³¨å†Œ Web Components ç»„ä»¶ï¼Œéœ€è¦åŠ è½½ defineCustomElements è„šæœ¬è‡ªåŠ¨æ³¨å†Œä½¿ç”¨çš„ç»„ä»¶\n        if (this.useDeprecatedAdapterComponent) {\n          args[0].loaderMeta.extraImportForWeb += `import { applyPolyfills, defineCustomElements } from '@tarojs/components/loader'\\n`\n          args[0].loaderMeta.execBeforeCreateWebApp += `applyPolyfills().then(() => defineCustomElements(window))\\n`\n        }\n\n        if (!this.useHtmlComponents) {\n          args[0].loaderMeta.extraImportForWeb += `import { defineCustomElementTaroPullToRefreshCore } from '@tarojs/components/dist/components'\\n`\n          args[0].loaderMeta.execBeforeCreateWebApp += `defineCustomElementTaroPullToRefreshCore()\\n`\n        }\n\n        switch (this.framework) {\n          case 'vue3':\n            args[0].loaderMeta.extraImportForWeb += `import { initVue3Components } from '@tarojs/components/lib/vue3/components-loader'\\nimport * as list from '@tarojs/components'\\n`\n            args[0].loaderMeta.execBeforeCreateWebApp += `initVue3Components(component, list)\\n`\n            break\n          default:\n            if (this.useHtmlComponents) {\n              args[0].loaderMeta.extraImportForWeb += `import '@tarojs/components-react/dist/index.css'\\nimport { PullDownRefresh } from '@tarojs/components'\\n`\n              args[0].loaderMeta.execBeforeCreateWebApp += `config.PullDownRefresh = PullDownRefresh\\n`\n            }\n        }\n        return args\n      })\n\n      // Note: æœ¬åœ°è°ƒè¯• stencil ç»„ä»¶åº“æ—¶ï¼Œå¦‚æžœå¯ç”¨ sourceMap åˆ™éœ€è¦ç›¸å…³é…ç½®\n      chain.module\n        .rule('map')\n        .test(/\\.map$/)\n        .type('json')\n    })\n  }\n\n  /**\n   * ä¿®æ”¹ Vite é…ç½®\n   */\n  modifyViteConfig() {\n    const that = this\n    const { runnerUtils } = this.ctx\n    const { getViteH5CompilerContext } = runnerUtils\n    that.ctx.modifyViteConfig?.(({ viteConfig }) => {\n      function aliasPlugin() {\n        return {\n          name: 'taro:vite-h5-alias',\n          config: () => ({\n            resolve: {\n              alias: [\n                { find: /@tarojs\\/components$/, replacement: that.componentLibrary },\n                { find: '@tarojs/components/lib', replacement: that.componentAdapter },\n                { find: /@tarojs\\/router$/, replacement: that.routerLibrary },\n                { find: '@tarojs/taro', replacement: that.apiLibrary },\n              ],\n            },\n          }),\n        }\n      }\n      function injectLoaderMeta() {\n        return {\n          name: 'taro:vite-h5-loader-meta',\n          async buildStart () {\n            const viteCompilerContext = await getViteH5CompilerContext(this)\n            if (viteCompilerContext) {\n              viteCompilerContext.loaderMeta ||= {\n                extraImportForWeb: '',\n                execBeforeCreateWebApp: '',\n              }\n\n              // Note: æ—§ç‰ˆæœ¬é€‚é…å™¨ä¸ä¼šè‡ªåŠ¨æ³¨å†Œ Web Components ç»„ä»¶ï¼Œéœ€è¦åŠ è½½ defineCustomElements è„šæœ¬è‡ªåŠ¨æ³¨å†Œä½¿ç”¨çš„ç»„ä»¶\n              if (that.useDeprecatedAdapterComponent) {\n                viteCompilerContext.loaderMeta.extraImportForWeb += `import { applyPolyfills, defineCustomElements } from '@tarojs/components/loader'\\n`\n                viteCompilerContext.loaderMeta.execBeforeCreateWebApp += `applyPolyfills().then(() => defineCustomElements(window))\\n`\n              }\n\n              if (!that.useHtmlComponents) {\n                viteCompilerContext.loaderMeta.extraImportForWeb += `import { defineCustomElementTaroPullToRefreshCore } from '@tarojs/components/dist/components'\\n`\n                viteCompilerContext.loaderMeta.execBeforeCreateWebApp += `defineCustomElementTaroPullToRefreshCore()\\n`\n              }\n\n              switch (that.framework) {\n                case 'vue3':\n                  viteCompilerContext.loaderMeta.extraImportForWeb += `import { initVue3Components } from '@tarojs/components/lib/vue3/components-loader'\\nimport * as list from '@tarojs/components'\\n`\n                  viteCompilerContext.loaderMeta.execBeforeCreateWebApp += `initVue3Components(component, list)\\n`\n                  break\n                default:\n                  if (that.useHtmlComponents) {\n                    viteCompilerContext.loaderMeta.extraImportForWeb += `import { PullDownRefresh } from '@tarojs/components'\\n`\n                    viteCompilerContext.loaderMeta.execBeforeCreateWebApp += `config.PullDownRefresh = PullDownRefresh\\n`\n                  }\n              }\n            }\n          },\n        }\n      }\n      function apiPlugin() {\n        return {\n          name: 'taro:vite-h5-api',\n          enforce: 'post',\n          async transform(code, id) {\n            const viteCompilerContext = await getViteH5CompilerContext(this)\n            if (viteCompilerContext) {\n              const exts = Array.from(new Set(viteCompilerContext.frameworkExts.concat(SCRIPT_EXT)))\n              let cleanId = id\n\n              if (cleanId.startsWith('\\u0000')) {\n                cleanId = cleanId.slice(1)\n              }\n\n              cleanId = cleanId.split('?')[0].replace(/\\\\/g, '/') // ðŸ‘ˆ æ›¿æ¢æ–œæ æ–¹å‘\n\n              const normalizedSourceDir = viteCompilerContext.sourceDir.replace(/\\\\/g, '/') // ðŸ‘ˆ æ›¿æ¢æ–œæ æ–¹å‘\n              if (cleanId.startsWith(normalizedSourceDir) && exts.some((ext) => id.includes(ext))) {\n                // @TODO åŽç»­è€ƒè™‘ä½¿ç”¨ SWC æ’ä»¶çš„æ–¹å¼å®žçŽ°\n                const result = await transformAsync(code, {\n                  filename: id,\n                  plugins: [\n                    [\n                      require('babel-plugin-transform-taroapi'),\n                      {\n                        packageName: '@tarojs/taro',\n                        definition: require(that.libraryDefinition)\n                      },\n                    ],\n                  ],\n                })\n                return {\n                  code: result?.code || code,\n                  map: result?.map || null,\n                }\n              }\n            }\n          },\n        }\n      }\n      viteConfig.plugins.push(aliasPlugin())\n      viteConfig.plugins.push(injectLoaderMeta())\n      viteConfig.plugins.push(apiPlugin())\n    })\n  }\n}\n","import H5 from './program'\n\nimport type { IPluginContext } from '@tarojs/service'\n\n// Note: è®©å…¶å®ƒå¹³å°æ’ä»¶å¯ä»¥ç»§æ‰¿æ­¤å¹³å°\nexport { H5 }\n\nexport default (ctx: IPluginContext) => {\n  ctx.registerPlatform({\n    name: 'h5',\n    useConfigName: 'h5',\n    async fn ({ config }) {\n      const program = new H5(ctx, config)\n      await program.start()\n    }\n  })\n}\n\nexport * from './utils'\n"],"names":["TaroPlatformWeb","defaultMainFields","resolveSync","SCRIPT_EXT","transformAsync","__awaiter"],"mappings":"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"}